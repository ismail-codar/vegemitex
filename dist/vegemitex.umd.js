(function(l,f){typeof exports=="object"&&typeof module!="undefined"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(l=typeof globalThis!="undefined"?globalThis:l||self,f(l.vegemitex={}))})(this,function(l){"use strict";function f(r){if(typeof r!="object")return r;var t,e,o=Object.prototype.toString.call(r);if(o==="[object Object]"){if(r.constructor!==Object&&typeof r.constructor=="function"){e=new r.constructor;for(t in r)e.hasOwnProperty(t)&&e[t]!==r[t]&&(e[t]=f(r[t]))}else{e={};for(t in r)t==="__proto__"?Object.defineProperty(e,t,{value:f(r[t]),configurable:!0,enumerable:!0,writable:!0}):e[t]=f(r[t])}return e}if(o==="[object Array]"){for(t=r.length,e=Array(t);t--;)e[t]=f(r[t]);return e}return o==="[object Set]"?(e=new Set,r.forEach(function(i){e.add(f(i))}),e):o==="[object Map]"?(e=new Map,r.forEach(function(i,c){e.set(f(c),f(i))}),e):o==="[object Date]"?new Date(+r):o==="[object RegExp]"?(e=new RegExp(r.source,r.flags),e.lastIndex=r.lastIndex,e):o.slice(-6)==="Array]"?new r.constructor(r):r}const d=r=>{var t=r;return e=>(e!==void 0&&(t=e),t)};function a(r,t,e,o,i){var c,n=r[o++];if(!n)return i?Promise.resolve(e):e;try{c=n(e,t)}catch(u){if(i)return Promise.reject(u);throw u}return c==null?a(r,t,e,o):typeof c.then=="function"?c.then(u=>a(r,t,u,o,!0)):(typeof c=="object"&&(e=c),a(r,t,e,o))}function b(r){var t,e={},o={},i=r||{},c=(n,u)=>{n.splice(n.indexOf(u)>>>0,1)};return t={get state(){return f(i)},on(n,u){return e[n]=(e[n]||[]).concat(u),()=>c(e[n],u)},set(n,u){return a((o["*"]||[]).concat(u&&o[u]||[]),i,f(i=n),0)},listen(n,u){return typeof n=="function"&&(u=n,n="*"),o[n]=(o[n]||[]).concat(u),()=>c(o[n],u)},dispatch(n,u){var p=a(e[n]||[],u,f(i),0);return typeof p.then=="function"?p.then(s=>{if(s==null)throw"state did not returned!";return t.set(s,n)}):t.set(p,n)}}}l.default=b,l.valueFn=d,Object.defineProperty(l,"__esModule",{value:!0}),l[Symbol.toStringTag]="Module"});
